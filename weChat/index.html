<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <link rel="stylesheet" href="./icon/iconfont.css" />
    <link rel="stylesheet" href="./css/common.css" />
    <link rel="stylesheet" href="./css/index.css" />
    <link rel="stylesheet" href="./css/chatInfo.css" />
    <link rel="stylesheet" href="./css/chatGroup.css" />
  </head>
  <body>
    <div id="container"></div>
  </body>

<script src="./lib/template-web.js"></script>
<script type="module">
    import Navigation from "./js/navigation.js";
    import observer from "./js/observer.js";
    import config from "./config/config.js";
    import {getPath} from "./util/utils.js";
				const navigator =  Navigation.getInstance(config);
				navigator.init();
			 const historyPulishEventer=(()=>{
					const publiser = observer;
					return (key)=>{
							if(key==='pulishPush'){
									return function (...args) {
											const [state,title,path] = args
											observer.publish('listenerPush',path);
											window.history.pushState(state,title,path)
									}
							}
							if(key==='pulishPop'){
								return function () {
											window.history.back()
											observer.publish('listenerPop',);
									}
							}
					}
				})();

				const historyListenerEventer=(()=>{
					const listener = observer;
					return (key)=>{
							if(key==='listenerPush'){
										return (callback)=>{
											listener.addListener('listenerPush',callback);
										}
							}
							if(key==='listenerPop'){
									return (callback)=>{
											listener.addListener('listenerPop',callback);
									}
							}
					}
				})();
		
				window.addGoEventListener = historyListenerEventer('listenerPush');
				window.addBackEventListener = historyListenerEventer('listenerPop');

				window.addGoEventListener((path)=>{
						navigator.go(path);
				})
				window.addBackEventListener(()=>{
						navigator.back();
				})

				history.push = historyPulishEventer('pulishPush');
				history.myBack = historyPulishEventer('pulishPop');
		
</script>
</html>
